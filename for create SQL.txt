CREATE TABLE public.managers
(
    manager_id integer GENERATED by DEFAULT AS identity primary key,
    name character varying(30) NOT NULL,
    surname character varying(30) NOT NULL,
    salary integer NOT NULL DEFAULT 10000
);

CREATE TABLE public.customers
(
    customer_id integer GENERATED by DEFAULT AS identity primary key,
    name character varying(30) NOT NULL,
    surname character varying(30) NOT NULL,
    email character varying(30) NOT NULL 
);

CREATE TABLE public.orders
(
    order_id integer GENERATED by DEFAULT AS identity primary key,
    address character varying(30) NOT NULL,
    decr character varying(30) NOT NULL,
    cost integer NOT NULL, 
	stage INTEGER NOT NULL DEFAULT 1,
	manager_id INTEGER,
	customer_id INTEGER
);

ALTER TABLE IF EXISTS public.orders
    ADD CONSTRAINT fk_order_manager FOREIGN KEY (manager_id)
    REFERENCES public.managers (manager_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE SET NULL
    NOT VALID;

ALTER TABLE IF EXISTS public.orders
    ADD CONSTRAINT fk_order_customer FOREIGN KEY (customer_id)
    REFERENCES public.managers (customer_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE SET NULL
    NOT VALID;
